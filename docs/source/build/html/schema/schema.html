

<!DOCTYPE html>


<html data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>InferenceData schema specification &#8212; XGenTS  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-codeautolink.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'schema/schema';</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo_dark.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../getting_started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../archive/index.html">
                        XGenTS Archive
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../ess_datasets/index.html">
                        ESS dataset
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../community.html">
                        Community
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing/index.html">
                        Contributing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../about.html">
                        About us
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/XgenTimeSeries/xgen-timeseries" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../getting_started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../archive/index.html">
                        XGenTS Archive
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../ess_datasets/index.html">
                        ESS dataset
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../community.html">
                        Community
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing/index.html">
                        Contributing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../about.html">
                        About us
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/XgenTimeSeries/xgen-timeseries" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="PyMC3_schema_example.html">PyMC3 example</a></li>
<li class="toctree-l1"><a class="reference internal" href="PyStan_schema_example.html">PyStan example</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">InferenceData schema specification</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="inferencedata-schema-specification">
<span id="schema"></span><h1>InferenceData schema specification<a class="headerlink" href="#inferencedata-schema-specification" title="Permalink to this headline">#</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">InferenceData</span></code> schema approach defines a data structure compatible with <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/">NetCDF</a>. Its purpose is to serve the following three goals:</p>
<ol class="arabic simple">
<li><p>Usefulness in the analysis of Bayesian inference results.</p></li>
<li><p>Reproducibility of Bayesian inference analysis.</p></li>
<li><p>Interoperability between different inference backends and programming languages.</p></li>
</ol>
<p>Currently there are <strong>two beta implementations</strong> of this design:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../index.html#homepage"><span class="std std-ref">XGenTS</span></a> in <strong>Python</strong> which integrates with:</p>
<ul>
<li><p><a class="reference external" href="https://emcee.readthedocs.io/en/stable/">emcee</a></p></li>
<li><p><a class="reference external" href="https://www.pymc.io">PyMC</a></p></li>
<li><p><a class="reference external" href="https://pyro.ai/">Pyro</a> and <a class="reference external" href="https://pyro.ai/numpyro/">NumPyro</a></p></li>
<li><p><a class="reference external" href="https://pystan.readthedocs.io/en/latest/index.html">PyStan</a>,
<a class="reference external" href="https://mc-stan.org/docs/cmdstan-guide/index.html">CmdStan</a> and
<a class="reference external" href="https://mc-stan.org/cmdstanpy/">CmdStanPy</a></p></li>
<li><p><a class="reference external" href="https://www.tensorflow.org/probability">TensorFlow Probability</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/XGenTS-devs/InferenceObjects.jl">InferenceObjects.jl</a> in <strong>Julia</strong> used in <a class="reference external" href="https://github.com/XGenTS-devs/XGenTS.jl">XGenTS.jl</a>, which integrates with:</p>
<ul>
<li><p><a class="reference external" href="https://github.com/StanJulia/CmdStan.jl">CmdStan.jl</a>, <a class="reference external" href="https://cscherrer.github.io/Soss.jl/stable/">Soss.jl</a>, <a class="reference external" href="https://github.com/StanJulia/StanSample.jl">StanSample.jl</a> and <a class="reference external" href="https://github.com/StanJulia/Stan.jl">Stan.jl</a></p></li>
<li><p><a class="reference external" href="https://turing.ml/dev/">Turing.jl</a> and indirectly any package using <a class="reference external" href="https://github.com/TuringLang/MCMCChains.jl">MCMCChains.jl</a> to store results</p></li>
</ul>
</li>
</ul>
<section id="terminology">
<h2>Terminology<a class="headerlink" href="#terminology" title="Permalink to this headline">#</a></h2>
<p>The terminology used in this specification is based on <a class="reference external" href="https://docs.xarray.dev/en/stable/user-guide/terminology.html#terminology" title="(in xarray v2023.5.1.dev0)"><span class="xref std std-ref">xarray’s terminology</span></a>, however, no xarray knowledge is assumed in this description, nor xarray is needed to use or interact with the schema.
There are also some extensions particular to  the <a class="reference internal" href="../getting_started/XarrayforXGenTS.html#xarray-for-xgents"><span class="std std-ref">InferenceData</span></a> case.</p>
<ul class="simple">
<li><p><strong>Variable</strong>: NetCDF-like variables are multidimensional labeled arrays representing a single quantity. Variables and their dimensions must be named. They can also have attributes describing it. Relevant terms related to <code class="docutils literal notranslate"><span class="pre">InferenceData</span></code> variables are following:</p>
<ul>
<li><p><em>variable_name</em></p></li>
<li><p><em>values</em> (its data)</p></li>
<li><p><em>dimensions</em></p></li>
<li><p><em>coordinates</em></p></li>
<li><p><em>attributes</em></p></li>
</ul>
</li>
<li><p><strong>Dimension</strong>: The dimensions of an object are its named axes. A variable containing 3D data can have dimensions <code class="docutils literal notranslate"><span class="pre">[chain,</span> <span class="pre">draw,</span> <span class="pre">dim0]</span></code>, i.e., its <code class="docutils literal notranslate"><span class="pre">0th</span></code>-dimension is <code class="docutils literal notranslate"><span class="pre">chain</span></code>, its <code class="docutils literal notranslate"><span class="pre">1st</span></code>-dimension is <code class="docutils literal notranslate"><span class="pre">draw</span></code>, and so on. Every dimension present in an <code class="docutils literal notranslate"><span class="pre">InferenceData</span></code> variable must share names with a <em>coordinate</em>. Given that dimensions must be named, dimension and dimension name are used equivalents.</p></li>
<li><p><strong>Coordinate</strong>: A named array that labels a dimension. A coordinate named <code class="docutils literal notranslate"><span class="pre">chain</span></code> with values <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code> would label the <code class="docutils literal notranslate"><span class="pre">chain</span></code> dimension. Coordinate names and values can be loosely thought of as labels and tick labels along a dimension, respectively.</p></li>
<li><p><strong>Attribute</strong>: An ordered dictionary that can store arbitrary metadata.</p></li>
<li><p><strong>Group</strong>: Dataset containing one or several variables with a conceptual link between them. Variables inside a group will generally share some dimensions too. For example, the <code class="docutils literal notranslate"><span class="pre">posterior</span></code> group contains a representation of the posterior distribution conditioned on the observations in the <code class="docutils literal notranslate"><span class="pre">observed_data</span></code> group.</p></li>
<li><p><strong>Matching samples</strong>: Two variables (or groups) will be called to have matching samples if they are generated with the same set of samples. Therefore, they will share dimensions and coordinates corresponding to the sampling process. Sample dimensions (generally <code class="docutils literal notranslate"><span class="pre">(chain,</span> <span class="pre">draw)</span></code>) are the ones introduced by the sampling process.</p></li>
<li><p><strong>Matching variables</strong>: Two groups with matching variables are groups that conceptually share variables, variable dimensions and coordinates of the variable dimensions but do not necessarily share variable names nor sample dimensions. Variable dimensions are the ones intrinsic to the data and model as opposed to sample dimensions which are the ones relative to the sampling process. When talking about specific variables, this same idea is expressed as one variable being the counterpart of the other.</p></li>
</ul>
</section>
<section id="current-design">
<h2>Current design<a class="headerlink" href="#current-design" title="Permalink to this headline">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">InferenceData</span></code> stores all quantities that are relevant to fulfilling its goals in different groups. Different groups generally distinguish conceptually different quantities in Bayesian inference, however, convenience in <a class="reference internal" href="../getting_started/CreatingInferenceData.html#creating-inferencedata"><span class="std std-ref">creation</span></a> and <a class="reference internal" href="../getting_started/WorkingWithInferenceData.html#working-with-inferencedata"><span class="std std-ref">usage</span></a> of <code class="docutils literal notranslate"><span class="pre">InferenceData</span></code> objects also plays a role. In general, each quantity (such as posterior distribution or observed data) will be represented by several multidimensional labeled variables.</p>
<section id="rules">
<h3>Rules<a class="headerlink" href="#rules" title="Permalink to this headline">#</a></h3>
<p>Below are a few rules that should be followed:</p>
<ul class="simple">
<li><p>Each group should have one entry per variable and each variable should be named.</p></li>
<li><p>Dimension names <code class="docutils literal notranslate"><span class="pre">chain</span></code>, <code class="docutils literal notranslate"><span class="pre">draw</span></code>, <code class="docutils literal notranslate"><span class="pre">sample</span></code> and <code class="docutils literal notranslate"><span class="pre">pred_id</span></code> are reserved for
InferenceData use to indicate sample dimensions.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">chain</span></code> indicates the MCMC chain</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">draw</span></code> indicates the iteration <em>within</em> each MCMC chain.
XGenTS assumes all chains have the same length for better interoperability with
NumPy and xarray.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code> indicates a unique id per value combining chain and draw. i.e. we often don’t
care about <code class="docutils literal notranslate"><span class="pre">chain</span></code> and <code class="docutils literal notranslate"><span class="pre">draw</span></code> when plotting and only want all the samples of the distribution
as a whole.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pred_id</span></code> is interpreted as the dimension storing multiple independent and identically
distributed values per sample.</p></li>
</ul>
</li>
<li><p>Dimensions in InferenceData (including sample dimensions) should be identified by name only. The
dimension order does not matter, only their names.</p></li>
<li><p>For groups like <code class="docutils literal notranslate"><span class="pre">observed_data</span></code> or <code class="docutils literal notranslate"><span class="pre">constant_data</span></code>, all sample dimensions can be
omitted. For groups like <code class="docutils literal notranslate"><span class="pre">prior</span></code>, <code class="docutils literal notranslate"><span class="pre">posterior</span></code> or <code class="docutils literal notranslate"><span class="pre">posterior_predictive</span></code> either <code class="docutils literal notranslate"><span class="pre">sample</span></code> has to be
present or both <code class="docutils literal notranslate"><span class="pre">chain</span></code> and <code class="docutils literal notranslate"><span class="pre">draw</span></code> dimensions need to be present. Any combinations that follow
this are valid.</p></li>
<li><p>Dimensions must be named and share name with a coordinate specifying the index values, called coordinate values.</p></li>
<li><p>Coordinate values can be repeated and should not necessarily be numerical values.</p></li>
<li><p>Variables must not share names with dimensions.</p></li>
<li><p>Groups, variables or the InferenceData itself can have arbitrary metadata stored.</p></li>
</ul>
</section>
<section id="metadata">
<h3>Metadata<a class="headerlink" href="#metadata" title="Permalink to this headline">#</a></h3>
<p>No metadata is <em>required</em> to be present in order to be compliant with the InferenceData schema.
However, it is recommended to store the following fields when relevant:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: InferenceData objects represent multiple quantities related to Bayesian modelling,
but they are all tied to a single model. The model identifier can be added as metadata
to simplify the calls to model comparison functions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">created_at</span></code>: the date of creation of the group.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">creation_library</span></code>: the library used to create the InferenceData (might not necessarly be XGenTS)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">creation_library_version</span></code>: the version of <code class="docutils literal notranslate"><span class="pre">creation_library</span></code> that generated the InferenceData</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">creation_library_language</span></code>: the programming language from which <code class="docutils literal notranslate"><span class="pre">creation_library</span></code> was used to create the InferenceData</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inference_library</span></code>: the library used to run the inference.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inference_library_version</span></code>: version of the inference library used.</p></li>
</ul>
<p>Metadata can be stored at the whole <code class="docutils literal notranslate"><span class="pre">InferenceData</span></code> level but also at group level when needed.</p>
</section>
<section id="relations-between-groups">
<h3>Relations between groups<a class="headerlink" href="#relations-between-groups" title="Permalink to this headline">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">InferenceData</span></code> data objects contain any combination of the groups described below. There are also some relations (detailed below) between the variables and dimensions of different groups. Hence, whenever related groups are present they should comply with these relations. Neither the presence of groups not described below or the lack of some of the groups described below go against the schema.</p>
<section id="posterior">
<h4><code class="docutils literal notranslate"><span class="pre">posterior</span></code><a class="headerlink" href="#posterior" title="Permalink to this headline">#</a></h4>
<p>Samples from the posterior distribution <span class="math notranslate nohighlight">\(p(\theta|y)\)</span> in the parameter (also called constrained) space.</p>
</section>
<section id="unconstrained-posterior">
<span id="schema-unconstrained-posterior"></span><h4><code class="docutils literal notranslate"><span class="pre">unconstrained_posterior</span></code><a class="headerlink" href="#unconstrained-posterior" title="Permalink to this headline">#</a></h4>
<p>Samples from the posterior distribution p(theta_transformed|y) in the unconstrained (also called transformed) space.</p>
<p>Only variables that undergo a transformation for sampling should be present here.
Therefore, to get the samples for <em>all</em> the variables in the unconstrained space,
variables should be taken from the <code class="docutils literal notranslate"><span class="pre">unconstrained_posterior</span></code> group if present,
and if not, then the values from the variable in the <code class="docutils literal notranslate"><span class="pre">posterior</span></code> group should be used.</p>
<p>Samples should match between the <code class="docutils literal notranslate"><span class="pre">posterior</span></code> and the <code class="docutils literal notranslate"><span class="pre">unconstrained_posterior</span></code> groups.
All variables in <code class="docutils literal notranslate"><span class="pre">unconstrained_posterior</span></code> should have a counterpart in <code class="docutils literal notranslate"><span class="pre">posterior</span></code>
with the same name. However, they don’t need to have the same dimensions nor shape.</p>
<div class="dropdown admonition note">
<p class="admonition-title">Note</p>
<p>Both InferenceData groups and variables can have metadata, which in the <code class="docutils literal notranslate"><span class="pre">unconstrained_posterior</span></code>
case could be used to store the transformations each variable goes through to map between the
constrained and unconstrained spaces. The schema leaves this completely up to the user
and imposes no conventions or restrictions on such metadata.</p>
</div>
</section>
<section id="sample-stats">
<span id="schema-sample-stats"></span><h4><code class="docutils literal notranslate"><span class="pre">sample_stats</span></code><a class="headerlink" href="#sample-stats" title="Permalink to this headline">#</a></h4>
<p>Information and diagnostics for each <code class="docutils literal notranslate"><span class="pre">posterior</span></code> sample, provided by the inference
backend. It may vary depending on the algorithm used by the backend (i.e. an affine
invariant sampler has no energy associated). Therefore none of these parameters
should be assumed to be present in the <code class="docutils literal notranslate"><span class="pre">sample_stats</span></code> group. The convention
below serves to ensure that if a variable is present with one of these names
it will correspond to the definition given in front of it.
Moreover, some <code class="docutils literal notranslate"><span class="pre">sample_stats</span></code> may be constant throughout the sampling
process; these variables don’t need to have any sampling dimensions.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-icon"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-list-unordered" viewBox="0 0 16 16" aria-hidden="true"><path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path></svg></span>Naming convention used for <code class="docutils literal notranslate"><span class="pre">sample_stats</span></code> variables<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<ul class="simple">
<li><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">lp</span></code>: The joint log posterior density for the model (up to an additive constant).</p></li>
<li><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">acceptance_rate</span></code>: The average acceptance probabilities of all possible samples in the proposed tree.</p></li>
<li><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">step_size</span></code>: The current integration step size.</p></li>
<li><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">step_size_nom</span></code>: The nominal integration step size. The <code class="docutils literal notranslate"><span class="pre">step_size</span></code> may differ from this for example, if the step size is jittered. It should only be present if <code class="docutils literal notranslate"><span class="pre">step_size</span></code> is also present and it varies between samples (i.e. step size is jittered).</p></li>
<li><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">tree_depth</span></code>: The number of tree doublings in the balanced binary tree.</p></li>
<li><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">n_steps</span></code>: The number of leapfrog steps computed. It is related to <code class="docutils literal notranslate"><span class="pre">tree_depth</span></code> with <code class="docutils literal notranslate"><span class="pre">n_steps</span> <span class="pre">&lt;=</span> <span class="pre">2^tree_dept</span></code>.</p></li>
<li><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">diverging</span></code>: (boolean) Indicates the presence of leapfrog transitions with large energy deviation
from starting and subsequent termination of the trajectory. “large” is defined as <code class="docutils literal notranslate"><span class="pre">max_energy_error</span></code> going over a threshold.</p></li>
<li><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">energy</span></code>: The value of the Hamiltonian energy for the accepted proposal (up to an
additive constant).</p></li>
<li><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">energy_error</span></code>: The difference in the Hamiltonian energy between the initial point and
the accepted proposal.</p></li>
<li><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">max_energy_error</span></code>: The maximum absolute difference in Hamiltonian energy between the initial point and all possible samples in the proposed tree.</p></li>
<li><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">int_time</span></code>: The total integration time (static HMC sampler)</p></li>
<li><p class="sd-card-text"><code class="docutils literal notranslate"><span class="pre">inv_metric</span></code>: Inverse metric (also known as inverse <em>mass matrix</em>) used in HMC samplers for the computation of the Hamiltonian.
When it is constant, the resulting implementation is known as Euclidean HMC;
in that case, the variable wouldn’t need to have any sampling dimensions
even if part of the <code class="docutils literal notranslate"><span class="pre">sample_stats</span></code> group.</p></li>
</ul>
</div>
</details></section>
<section id="log-likelihood">
<h4><code class="docutils literal notranslate"><span class="pre">log_likelihood</span></code><a class="headerlink" href="#log-likelihood" title="Permalink to this headline">#</a></h4>
<p>Pointwise log likelihood data. Samples should match with <code class="docutils literal notranslate"><span class="pre">posterior</span></code> ones and its variables
should match <code class="docutils literal notranslate"><span class="pre">observed_data</span></code> variables. The <code class="docutils literal notranslate"><span class="pre">observed_data</span></code> counterpart variable
may have a different name. Moreover, some cases such as a multivariate normal
may require some dimensions or coordinates to be different.</p>
</section>
<section id="posterior-predictive">
<h4><code class="docutils literal notranslate"><span class="pre">posterior_predictive</span></code><a class="headerlink" href="#posterior-predictive" title="Permalink to this headline">#</a></h4>
<p>Posterior predictive samples p(y|y) corresponding to the posterior predictive distribution evaluated at the <code class="docutils literal notranslate"><span class="pre">observed_data</span></code>. Samples should match with <code class="docutils literal notranslate"><span class="pre">posterior</span></code> ones and its variables should match <code class="docutils literal notranslate"><span class="pre">observed_data</span></code> variables. The <code class="docutils literal notranslate"><span class="pre">observed_data</span></code> counterpart variable may have a different name.</p>
</section>
<section id="observed-data">
<h4><code class="docutils literal notranslate"><span class="pre">observed_data</span></code><a class="headerlink" href="#observed-data" title="Permalink to this headline">#</a></h4>
<p>Observed data on which the <code class="docutils literal notranslate"><span class="pre">posterior</span></code> is conditional. It should only contain data which is modeled as a random variable. Each variable should have a counterpart in <code class="docutils literal notranslate"><span class="pre">posterior_predictive</span></code>, however, the <code class="docutils literal notranslate"><span class="pre">posterior_predictive</span></code> counterpart variable may have a different name.</p>
</section>
<section id="constant-data">
<h4><code class="docutils literal notranslate"><span class="pre">constant_data</span></code><a class="headerlink" href="#constant-data" title="Permalink to this headline">#</a></h4>
<p>Model constants, data included in the model which is not modeled as a random variable. It should be the data used to generate samples in all the groups except the <code class="docutils literal notranslate"><span class="pre">predictions</span></code> groups.</p>
</section>
<section id="prior">
<h4><code class="docutils literal notranslate"><span class="pre">prior</span></code><a class="headerlink" href="#prior" title="Permalink to this headline">#</a></h4>
<p>Samples from the prior distribution p(theta). Samples do not need to match <code class="docutils literal notranslate"><span class="pre">posterior</span></code> samples. However, this group will still follow the convention on <code class="docutils literal notranslate"><span class="pre">chain</span></code> and <code class="docutils literal notranslate"><span class="pre">draw</span></code> as first dimensions. It should have matching variables with the <code class="docutils literal notranslate"><span class="pre">posterior</span></code> group.</p>
</section>
<section id="prior-predictive">
<h4><code class="docutils literal notranslate"><span class="pre">prior_predictive</span></code><a class="headerlink" href="#prior-predictive" title="Permalink to this headline">#</a></h4>
<p>Samples from the prior predictive distribution. Samples should match <code class="docutils literal notranslate"><span class="pre">prior</span></code> samples and each variable should have a counterpart in <code class="docutils literal notranslate"><span class="pre">posterior_predictive</span></code>/<code class="docutils literal notranslate"><span class="pre">observed_data</span></code>.</p>
</section>
<section id="predictions">
<h4><code class="docutils literal notranslate"><span class="pre">predictions</span></code><a class="headerlink" href="#predictions" title="Permalink to this headline">#</a></h4>
<p>Out of sample posterior predictive samples p(y’|y). Samples should match <code class="docutils literal notranslate"><span class="pre">posterior</span></code> samples. Its variables should have a counterpart in <code class="docutils literal notranslate"><span class="pre">posterior_predictive</span></code>. However, variables in <code class="docutils literal notranslate"><span class="pre">predictions</span></code> and their counterpart in <code class="docutils literal notranslate"><span class="pre">posterior_predictive</span></code> can have different coordinate values.</p>
</section>
<section id="predictions-constant-data">
<h4><code class="docutils literal notranslate"><span class="pre">predictions_constant_data</span></code><a class="headerlink" href="#predictions-constant-data" title="Permalink to this headline">#</a></h4>
<p>Model constants used to get the <code class="docutils literal notranslate"><span class="pre">predictions</span></code> samples. Its variables should have a counterpart in <code class="docutils literal notranslate"><span class="pre">constant_data</span></code>. However, variables in <code class="docutils literal notranslate"><span class="pre">predictions_constant_data</span></code> and their counterpart in <code class="docutils literal notranslate"><span class="pre">constant_data</span></code> can have different coordinate values.</p>
<div class="note dropdown admonition">
<p class="admonition-title">Note on sample stats, warmup and unconstrained groups</p>
<p>The schema does not define which warmup or unconstrained groups exist or can exist
by default. We recognize both the samplers and the models are continuously evolving.
Some models already require the use of sampling algorithms to get prior samples,
in which case we basically need to treat the prior and posterior groups in the same way.</p>
<p>We define the prefixes to allow libraries that use InferenceData to be aware
of the potential relations and hopefully support as many cases as possible.
Back to the case above, it might be necessary to generate a pair plot
for prior samples generated with NUTS <em>and</em> its associated divergences,
which would then come from <code class="docutils literal notranslate"><span class="pre">sample_stats_prior</span></code>.</p>
</div>
</section>
<section id="sample-stats-groups">
<h4>Sample stats groups<a class="headerlink" href="#sample-stats-groups" title="Permalink to this headline">#</a></h4>
<p>Information and diagnostics for the samples in any InferenceData group
other than the posterior should be stored in a separate group with the
<code class="docutils literal notranslate"><span class="pre">sample_stats_</span></code> prefix. For example <code class="docutils literal notranslate"><span class="pre">sample_stats_prior</span></code>.</p>
<p>The same rules and conventions defined in <a class="reference internal" href="#schema-sample-stats"><span class="std std-ref">sample_stats</span></a> apply to
any sample stats group.</p>
</section>
<section id="warmup-groups">
<h4>Warmup groups<a class="headerlink" href="#warmup-groups" title="Permalink to this headline">#</a></h4>
<p>Samples generated during the adaptation/warmup phases of algorithms like HMC
can also be stored in InferenceData. In such cases, the data/samples
generated during the adaptation process should be stored in groups with
the same name with the <code class="docutils literal notranslate"><span class="pre">warmup_</span></code> prefix, e.g. <code class="docutils literal notranslate"><span class="pre">warmup_posterior</span></code>, <code class="docutils literal notranslate"><span class="pre">warmup_sample_stats_prior</span></code>.
The <code class="docutils literal notranslate"><span class="pre">warmup_</span></code> prefix goes before other prefixes.</p>
</section>
<section id="unconstrained-groups">
<h4>Unconstrained groups<a class="headerlink" href="#unconstrained-groups" title="Permalink to this headline">#</a></h4>
<p>Samples on the unconstrained space in cases where the samples need to be generated with
the help of a sampling algorithm and the sampling algorithm requires transformations
to an unconstrained space.</p>
<p>It is described in more detail in <a class="reference internal" href="#schema-unconstrained-posterior"><span class="std std-ref">unconstrained_posterior</span></a> section, which
is what we expect to be the most common section, but other groups could also have
an unconstrained linked group, e.g. <code class="docutils literal notranslate"><span class="pre">prior</span></code> and <code class="docutils literal notranslate"><span class="pre">unconstrained_prior</span></code>.</p>
</section>
</section>
</section>
<section id="planned-features">
<h2>Planned features<a class="headerlink" href="#planned-features" title="Permalink to this headline">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">InferenceData</span></code> structure is still evolving, with some feature being currently developed. This section aims to describe the roadmap of the specification.</p>
<section id="sampler-parameters">
<h3>Sampler parameters<a class="headerlink" href="#sampler-parameters" title="Permalink to this headline">#</a></h3>
<p>Parameters of the sampling algorithm and sampling backend to be used for analysis reproducibility.</p>
</section>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">#</a></h2>
<p>In order to clarify the definitions above, an example of <code class="docutils literal notranslate"><span class="pre">InferenceData</span></code> generation for a 1D linear regression is available in several programming languages and probabilistic programming frameworks. This particular inference task has been chosen because it is widely well known while still being useful and it also allows to populate all the fields in the <code class="docutils literal notranslate"><span class="pre">InferenceData</span></code> object.</p>
<section id="python">
<h3>Python<a class="headerlink" href="#python" title="Permalink to this headline">#</a></h3>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="PyMC3_schema_example.html">PyMC3 example</a></li>
<li class="toctree-l1"><a class="reference internal" href="PyStan_schema_example.html">PyStan example</a></li>
</ul>
</div>
</section>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#terminology">Terminology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#current-design">Current design</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rules">Rules</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metadata">Metadata</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relations-between-groups">Relations between groups</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#posterior"><code class="docutils literal notranslate"><span class="pre">posterior</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#unconstrained-posterior"><code class="docutils literal notranslate"><span class="pre">unconstrained_posterior</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-stats"><code class="docutils literal notranslate"><span class="pre">sample_stats</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#log-likelihood"><code class="docutils literal notranslate"><span class="pre">log_likelihood</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#posterior-predictive"><code class="docutils literal notranslate"><span class="pre">posterior_predictive</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#observed-data"><code class="docutils literal notranslate"><span class="pre">observed_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#constant-data"><code class="docutils literal notranslate"><span class="pre">constant_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prior"><code class="docutils literal notranslate"><span class="pre">prior</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prior-predictive"><code class="docutils literal notranslate"><span class="pre">prior_predictive</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#predictions"><code class="docutils literal notranslate"><span class="pre">predictions</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#predictions-constant-data"><code class="docutils literal notranslate"><span class="pre">predictions_constant_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-stats-groups">Sample stats groups</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#warmup-groups">Warmup groups</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#unconstrained-groups">Unconstrained groups</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#planned-features">Planned features</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sampler-parameters">Sampler parameters</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python">Python</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
<div id="searchbox"></div></div>

  <div class="sidebar-secondary-item">
  
  <div class="tocsection editthispage">
    <a href="https://github.com/XGenTS-devs/XGenTS/edit/main/docs/source/schema/schema.md">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../_sources/schema/schema.md.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  

  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>


<script>
  $(document).ready(function () {
    const content = $('<div class="alert-danger">XGenTS docs will now be available at <a href="https://python.XGenTS.org">python.XGenTS.org</a>!</div>')
    $('#banner').append(content);
  })
</script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2023, XGenTS devs.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>