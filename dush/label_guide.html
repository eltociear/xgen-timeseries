
<!DOCTYPE html>

<html data-theme="light">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator"/>
<title>Label guide — XGenTS  documentation</title>
<script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
<!-- Loaded before other Sphinx assets -->
<link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet"/>
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2"/>
<link href="../_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="../_static/plot_directive.css" rel="stylesheet" type="text/css"/>
<link href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" rel="stylesheet" type="text/css"/>
<link href="../_static/copybutton.css" rel="stylesheet" type="text/css"/>
<link href="../_static/sphinx-codeautolink.css" rel="stylesheet" type="text/css"/>
<link href="../_static/jupyter-sphinx.css" rel="stylesheet" type="text/css"/>
<link href="../_static/thebelab.css" rel="stylesheet" type="text/css"/>
<link href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" rel="stylesheet" type="text/css"/>
<link href="../_static/custom.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" rel="preload"/>
<link as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" rel="preload"/>
<script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
<script src="../_static/jquery.js"></script>
<script src="../_static/underscore.js"></script>
<script src="../_static/doctools.js"></script>
<script src="../_static/clipboard.min.js"></script>
<script src="../_static/copybutton.js"></script>
<script src="../_static/thebelab-helper.js"></script>
<script src="../_static/design-tabs.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
<script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>DOCUMENTATION_OPTIONS.pagename = 'dush/label_guide';</script>
<link href="../_static/favicon.ico" rel="shortcut icon"/>
<link href="../about.html" rel="author" title="About these documents"/>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
</head>
<body data-bs-root-margin="0px 0px -60%" data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-default-mode="light" data-offset="180">
<a class="skip-link" href="#main-content">Skip to main content</a>
<input class="sidebar-toggle" id="__primary" name="__primary" type="checkbox"/>
<label class="overlay overlay-primary" for="__primary"></label>
<input class="sidebar-toggle" id="__secondary" name="__secondary" type="checkbox"/>
<label class="overlay overlay-secondary" for="__secondary"></label>
<div class="search-button__wrapper">
<div class="search-button__overlay"></div>
<div class="search-button__search-container">
<form action="../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search the docs ..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search the docs ..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
</div>
<nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
<label class="sidebar-toggle primary-toggle" for="__primary">
<span class="fa-solid fa-bars"></span>
</label>
<div class="navbar-header-items__start">
<div class="navbar-item">
<a class="navbar-brand logo" href="../index.html">
<img alt="Logo image" class="logo__image only-light" src="../_static/logo.png"/>
<script>document.write(`<img src="../_static/logo_dark.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
</a></div>
</div>
<div class="col-lg-9 navbar-header-items">
<div class="me-auto navbar-header-items__center">
<div class="navbar-item"><nav class="navbar-nav">
<p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
    Site Navigation
  </p>
<ul class="bd-navbar-elements navbar-nav">
<li class="nav-item">
<a class="nav-link nav-internal" href="../getting_started/index.html">
                        Getting Started
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../archive/index.html">
                        XGenTS Archive
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../ess_datasets/index.html">
                        ESS dataset
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../community.html">
                        Community
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../contributing/index.html">
                        Contributing
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../about.html">
                        About us
                      </a>
</li>
</ul>
</nav></div>
</div>
<div class="navbar-header-items__end">
<div class="navbar-item navbar-persistent--container">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
</div>
<div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
<div class="navbar-item"><ul aria-label="Icon Links" class="navbar-icon-links navbar-nav">
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/XgenTimeSeries/xgen-timeseries" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-github"></i></span>
<label class="sr-only">GitHub</label></a>
</li>
</ul></div>
</div>
</div>
<div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
</div>
<label class="sidebar-toggle secondary-toggle" for="__secondary">
<span class="fa-solid fa-outdent"></span>
</label>
</div>
</nav>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<div class="bd-sidebar-primary bd-sidebar hide-on-wide">
<div class="sidebar-header-items sidebar-primary__section">
<div class="sidebar-header-items__center">
<div class="navbar-item"><nav class="navbar-nav">
<p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
    Site Navigation
  </p>
<ul class="bd-navbar-elements navbar-nav">
<li class="nav-item">
<a class="nav-link nav-internal" href="../getting_started/index.html">
                        Getting Started
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../archive/index.html">
                        XGenTS Archive
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../ess_datasets/index.html">
                        ESS dataset
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../community.html">
                        Community
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../contributing/index.html">
                        Contributing
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../about.html">
                        About us
                      </a>
</li>
</ul>
</nav></div>
</div>
<div class="sidebar-header-items__end">
<div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
<div class="navbar-item"><ul aria-label="Icon Links" class="navbar-icon-links navbar-nav">
<li class="nav-item">
<a class="nav-link" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/XgenTimeSeries/xgen-timeseries" rel="noopener" target="_blank" title="GitHub"><span><i class="fa-brands fa-github"></i></span>
<label class="sr-only">GitHub</label></a>
</li>
</ul></div>
</div>
</div>
<div class="sidebar-primary-items__end sidebar-primary__section">
</div>
<div id="rtd-footer-container"></div>
</div>
<main class="bd-main" id="main-content">
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article">
<div class="header-article-items header-article__inner">
<div class="header-article-items__start">
<div class="header-article-item">
<nav aria-label="Breadcrumbs">
<ul aria-label="Breadcrumb" class="bd-breadcrumbs" role="navigation">
<li class="breadcrumb-item breadcrumb-home">
<a aria-label="Home" class="nav-link" href="../index.html">
<i class="fa-solid fa-home"></i>
</a>
</li>
<li aria-current="page" class="breadcrumb-item active">Label guide</li>
</ul>
</nav>
</div>
</div>
</div>
</div>
<div id="searchbox"></div>
<article class="bd-article" role="main">
<section id="label-guide">
<span id="id1"></span><h1>Label guide<a class="headerlink" href="#label-guide" title="Permalink to this headline">#</a></h1>
<section id="basic-labelling">
<h2>Basic labelling<a class="headerlink" href="#basic-labelling" title="Permalink to this headline">#</a></h2>
<p>All XGenTS plotting functions and some stats functions can take an optional <code class="docutils literal notranslate"><span class="pre">labeller</span></code> argument.
By default, labels show the variable name.
Multidimensional variables also show the coordinate value.</p>
<section id="example-default-labelling">
<h3>Example: Default labelling<a class="headerlink" href="#example-default-labelling" title="Permalink to this headline">#</a></h3>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">xgen</span> <span class="k">as</span> <span class="nn">xg</span>
<span class="gp">   ...: </span><span class="n">schools</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">load_XGenTS_data</span><span class="p">(</span><span class="s2">"centered_eight"</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">schools</span><span class="p">)</span>
<span class="gp">   ...: </span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">xgen</span> <span class="k">as</span> <span class="nn">xg</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">schools</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">load_XGenTS_data</span><span class="p">(</span><span class="s2">"centered_eight"</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">schools</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named 'xgen'
</pre></div>
</div>
<p>XGenTS supports label based indexing powered by <a class="reference external" href="http://xarray.pydata.org/en/stable/getting-started-guide/why-xarray.html">xarray</a>.
Through label based indexing, you can use labels to plot a subset of selected variables.</p>
</section>
<section id="example-label-based-indexing">
<h3>Example: Label based indexing<a class="headerlink" href="#example-label-based-indexing" title="Permalink to this headline">#</a></h3>
<p>For a case where the coordinate values shown for the <code class="docutils literal notranslate"><span class="pre">theta</span></code> variable coordinate to the <code class="docutils literal notranslate"><span class="pre">school</span></code> dimension,
you can indicate XGenTS to plot <code class="docutils literal notranslate"><span class="pre">tau</span></code> by including it in the <code class="docutils literal notranslate"><span class="pre">var_names</span></code> argument to inspect its 1.03 <code class="xref py py-func docutils literal notranslate"><span class="pre">rhat()</span></code> value.
To inspect the <code class="docutils literal notranslate"><span class="pre">theta</span></code> values for the <code class="docutils literal notranslate"><span class="pre">Choate</span></code> and <code class="docutils literal notranslate"><span class="pre">St.</span> <span class="pre">Paul's</span></code> coordinates, you can include <code class="docutils literal notranslate"><span class="pre">theta</span></code> in <code class="docutils literal notranslate"><span class="pre">var_names</span></code> and use the <code class="docutils literal notranslate"><span class="pre">coords</span></code> argument to select only these two coordinate values.
You can generate this plot with the following command:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [2]: </span><span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">schools</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="p">[</span><span class="s2">"tau"</span><span class="p">,</span> <span class="s2">"theta"</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">"school"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Choate"</span><span class="p">,</span> <span class="s2">"St. Paul's"</span><span class="p">]},</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../_images/label_guide_plot_trace.png" src="../_images/label_guide_plot_trace.png"/>
<p>Using the above command, you can now identify issues for low <code class="docutils literal notranslate"><span class="pre">tau</span></code> values.</p>
</section>
<section id="example-using-the-labeller-argument">
<h3>Example: Using the labeller argument<a class="headerlink" href="#example-using-the-labeller-argument" title="Permalink to this headline">#</a></h3>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">labeller</span></code> argument to customize labels.
Unlike the default labels that show <code class="docutils literal notranslate"><span class="pre">theta</span></code>, not <span class="math notranslate nohighlight">\(\theta\)</span> (generated from <code class="docutils literal notranslate"><span class="pre">$\theta$</span></code> using <span class="math notranslate nohighlight">\(\LaTeX\)</span>), the <code class="docutils literal notranslate"><span class="pre">labeller</span></code> argument presents the labels with proper math notation.</p>
<p>You can use <code class="xref py py-class docutils literal notranslate"><span class="pre">MapLabeller</span></code> to rename the variable <code class="docutils literal notranslate"><span class="pre">theta</span></code> to <code class="docutils literal notranslate"><span class="pre">$\theta$</span></code>, as shown in the following example:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="kn">import</span> <span class="nn">XGenTS.labels</span> <span class="k">as</span> <span class="nn">azl</span>
<span class="gp">   ...: </span><span class="n">labeller</span> <span class="o">=</span> <span class="n">azl</span><span class="o">.</span><span class="n">MapLabeller</span><span class="p">(</span><span class="n">var_name_map</span><span class="o">=</span><span class="p">{</span><span class="s2">"theta"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\theta$"</span><span class="p">})</span>
<span class="gp">   ...: </span><span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"school"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Deerfield"</span><span class="p">,</span> <span class="s2">"Hotchkiss"</span><span class="p">,</span> <span class="s2">"Lawrenceville"</span><span class="p">]}</span>
<span class="gp">   ...: </span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">XGenTS.labels</span> <span class="k">as</span> <span class="nn">azl</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">labeller</span> <span class="o">=</span> <span class="n">azl</span><span class="o">.</span><span class="n">MapLabeller</span><span class="p">(</span><span class="n">var_name_map</span><span class="o">=</span><span class="p">{</span><span class="s2">"theta"</span><span class="p">:</span> <span class="sa">r</span><span class="s2">"$\theta$"</span><span class="p">})</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"school"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Deerfield"</span><span class="p">,</span> <span class="s2">"Hotchkiss"</span><span class="p">,</span> <span class="s2">"Lawrenceville"</span><span class="p">]}</span>

<span class="ne">ModuleNotFoundError</span>: No module named 'XGenTS'

<span class="gp">In [4]: </span><span class="n">az</span><span class="o">.</span><span class="n">plot_posterior</span><span class="p">(</span><span class="n">schools</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="s2">"theta"</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span> <span class="n">labeller</span><span class="o">=</span><span class="n">labeller</span><span class="p">,</span> <span class="n">ref_val</span><span class="o">=</span><span class="mi">5</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../_images/label_guide_plot_posterior.png" src="../_images/label_guide_plot_posterior.png"/>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>For a list of labellers available in XGenTS, see the <span class="xref std std-ref">the API reference page</span>.</p>
</div>
</section>
</section>
<section id="sorting-labels">
<h2>Sorting labels<a class="headerlink" href="#sorting-labels" title="Permalink to this headline">#</a></h2>
<p>XGenTS allows labels to be sorted in two ways:</p>
<ol class="arabic simple">
<li><p>Using the arguments passed to XGenTS plotting functions</p></li>
<li><p>Sorting the underlying <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2023.8.1.dev0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a></p></li>
</ol>
<p>The first option is more suitable for single time ordering whereas the second option is more suitable for sorting plots consistently.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Both ways are limited.
Multidimensional variables can not be separated.
For example, it is possible to sort <code class="docutils literal notranslate"><span class="pre">theta,</span> <span class="pre">mu,</span></code> or <code class="docutils literal notranslate"><span class="pre">tau</span></code> in any order, and within <code class="docutils literal notranslate"><span class="pre">theta</span></code> to sort the schools in any order, but it is not possible to sort half of the schools, then <code class="docutils literal notranslate"><span class="pre">mu</span></code> and <code class="docutils literal notranslate"><span class="pre">tau</span></code> and then the rest of the schools.</p>
</div>
<section id="sorting-variable-names">
<h3>Sorting variable names<a class="headerlink" href="#sorting-variable-names" title="Permalink to this headline">#</a></h3>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">var_order</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"theta"</span><span class="p">,</span> <span class="s2">"mu"</span><span class="p">,</span> <span class="s2">"tau"</span><span class="p">]</span>
</pre></div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio"/>
<label class="sd-tab-label" for="sd-tab-item-0">
XGenTS args</label><div class="sd-tab-content docutils">
<p>For variable names to appear sorted when calling XGenTS functions, pass a sorted list of the variable names.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">schools</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="n">var_order</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">schools</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="n">var_order</span><span class="p">)</span>

<span class="ne">NameError</span>: name 'az' is not defined
</pre></div>
</div>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio"/>
<label class="sd-tab-label" for="sd-tab-item-1">
xarray</label><div class="sd-tab-content docutils">
<p>In xarray, subsetting the Dataset with a sorted list of variable names will order the Dataset.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="n">schools</span><span class="o">.</span><span class="n">posterior</span> <span class="o">=</span> <span class="n">schools</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="n">var_order</span><span class="p">]</span>
<span class="gp">   ...: </span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">schools</span><span class="p">)</span>
<span class="gp">   ...: </span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">schools</span><span class="o">.</span><span class="n">posterior</span> <span class="o">=</span> <span class="n">schools</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="n">var_order</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">schools</span><span class="p">)</span>

<span class="ne">NameError</span>: name 'schools' is not defined
</pre></div>
</div>
</div>
</div>
</section>
<section id="sorting-coordinate-values">
<h3>Sorting coordinate values<a class="headerlink" href="#sorting-coordinate-values" title="Permalink to this headline">#</a></h3>
<p>For sorting coordinate values, first, define the order, then store it, and use the result to sort the coordinate values.
You can define the order by creating a list manually or by using xarray objects as illustrated in the below example “Sorting out the schools by mean”.</p>
</section>
<section id="example-sorting-the-schools-by-mean">
<h3>Example: Sorting the schools by mean<a class="headerlink" href="#example-sorting-the-schools-by-mean" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Locate the means of each school by using the following command:</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">school_means</span> <span class="o">=</span> <span class="n">schools</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="s2">"theta"</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s2">"chain"</span><span class="p">,</span> <span class="s2">"draw"</span><span class="p">))</span>
<span class="gp">   ...: </span><span class="n">school_means</span>
<span class="gp">   ...: </span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">school_means</span> <span class="o">=</span> <span class="n">schools</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="s2">"theta"</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s2">"chain"</span><span class="p">,</span> <span class="s2">"draw"</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">school_means</span>

<span class="ne">NameError</span>: name 'schools' is not defined
</pre></div>
</div>
<ul class="simple">
<li><p>You can use the <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> result to sort the coordinate values for <code class="docutils literal notranslate"><span class="pre">theta</span></code>.</p></li>
</ul>
<p>There are two ways of sorting:</p>
<ol class="arabic simple">
<li><p>XGenTS args</p></li>
<li><p>xarray</p></li>
</ol>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-2" name="sd-tab-set-1" type="radio"/>
<label class="sd-tab-label" for="sd-tab-item-2">
XGenTS args</label><div class="sd-tab-content docutils">
<p>Sort the coordinate values to pass them as a <code class="docutils literal notranslate"><span class="pre">coords</span></code> argument and choose the order of the rows.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="n">sorted_schools</span> <span class="o">=</span> <span class="n">schools</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="s2">"school"</span><span class="p">]</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="n">school_means</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">schools</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="s2">"theta"</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">"school"</span><span class="p">:</span> <span class="n">sorted_schools</span><span class="p">})</span>
<span class="gp">   ...: </span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">sorted_schools</span> <span class="o">=</span> <span class="n">schools</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="s2">"school"</span><span class="p">]</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="n">school_means</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">schools</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="s2">"theta"</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">"school"</span><span class="p">:</span> <span class="n">sorted_schools</span><span class="p">})</span>

<span class="ne">NameError</span>: name 'schools' is not defined
</pre></div>
</div>
</div>
<input id="sd-tab-item-3" name="sd-tab-set-1" type="radio"/>
<label class="sd-tab-label" for="sd-tab-item-3">
xarray</label><div class="sd-tab-content docutils">
<p>You can use the <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.sortby.html#xarray.Dataset.sortby" title="(in xarray v2023.8.1.dev0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sortby()</span></code></a> method to order our coordinate values directly at the source.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [10]: </span><span class="n">schools</span><span class="o">.</span><span class="n">posterior</span> <span class="o">=</span> <span class="n">schools</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="n">school_means</span><span class="p">)</span>
<span class="gp">   ....: </span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">schools</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="s2">"theta"</span><span class="p">)</span>
<span class="gp">   ....: </span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">schools</span><span class="o">.</span><span class="n">posterior</span> <span class="o">=</span> <span class="n">schools</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="n">school_means</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">schools</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="s2">"theta"</span><span class="p">)</span>

<span class="ne">NameError</span>: name 'schools' is not defined
</pre></div>
</div>
</div>
</div>
</section>
<section id="sorting-dimensions">
<h3>Sorting dimensions<a class="headerlink" href="#sorting-dimensions" title="Permalink to this headline">#</a></h3>
<p>In some cases, our multidimensional variables may not have only one more dimension (a length <code class="docutils literal notranslate"><span class="pre">n</span></code> dimension
in addition to the <code class="docutils literal notranslate"><span class="pre">chain</span></code> and <code class="docutils literal notranslate"><span class="pre">draw</span></code> ones)
but could have multiple more dimensions.
Let’s imagine we have performed a set of fixed experiments on several days to multiple subjects,
three data dimensions overall.</p>
<p>We will create fake inference data with data mimicking this situation to show how to sort dimensions.
To keep things short and not clutter the guide too much with unnecessary output lines,
we will stick to a posterior of a single variable and the dimension sizes will be <code class="docutils literal notranslate"><span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">default_rng</span>
<span class="gp">   ....: </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://pandas.pydata.org/pandas-docs/stable/index.html#module-pandas" title="pandas"><span class="nn">pandas</span></a> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">   ....: </span><span class="n">rng</span> <span class="o">=</span> <span class="n">default_rng</span><span class="p">()</span>
<span class="gp">   ....: </span><span class="n">samples</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">   ....: </span><span class="n">coords</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">   ....: </span>    <span class="s2">"subject"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"ecoli"</span><span class="p">,</span> <span class="s2">"pseudomonas"</span><span class="p">,</span> <span class="s2">"clostridium"</span><span class="p">],</span>
<span class="gp">   ....: </span>    <span class="s2">"date"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"1-3-2020"</span><span class="p">,</span> <span class="s2">"2-4-2020"</span><span class="p">,</span> <span class="s2">"1-5-2020"</span><span class="p">,</span> <span class="s2">"1-6-2020"</span><span class="p">],</span>
<span class="gp">   ....: </span>    <span class="s2">"experiment"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">   ....: </span><span class="p">}</span>
<span class="gp">   ....: </span><span class="n">experiments</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="n">posterior</span><span class="o">=</span><span class="p">{</span><span class="s2">"b"</span><span class="p">:</span> <span class="n">samples</span><span class="p">},</span> <span class="n">dims</span><span class="o">=</span><span class="p">{</span><span class="s2">"b"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"experiment"</span><span class="p">,</span> <span class="s2">"subject"</span><span class="p">,</span> <span class="s2">"date"</span><span class="p">]},</span> <span class="n">coords</span><span class="o">=</span><span class="n">coords</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span><span class="n">experiments</span><span class="o">.</span><span class="n">posterior</span>
<span class="gp">   ....: </span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="n">line</span> <span class="mi">10</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">samples</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="s2">"subject"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"ecoli"</span><span class="p">,</span> <span class="s2">"pseudomonas"</span><span class="p">,</span> <span class="s2">"clostridium"</span><span class="p">],</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="s2">"date"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"1-3-2020"</span><span class="p">,</span> <span class="s2">"2-4-2020"</span><span class="p">,</span> <span class="s2">"1-5-2020"</span><span class="p">,</span> <span class="s2">"1-6-2020"</span><span class="p">],</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>     <span class="s2">"experiment"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="p">}</span>
<span class="ne">---&gt; </span><span class="mi">10</span> <span class="n">experiments</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>     <span class="n">posterior</span><span class="o">=</span><span class="p">{</span><span class="s2">"b"</span><span class="p">:</span> <span class="n">samples</span><span class="p">},</span> <span class="n">dims</span><span class="o">=</span><span class="p">{</span><span class="s2">"b"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"experiment"</span><span class="p">,</span> <span class="s2">"subject"</span><span class="p">,</span> <span class="s2">"date"</span><span class="p">]},</span> <span class="n">coords</span><span class="o">=</span><span class="n">coords</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="n">experiments</span><span class="o">.</span><span class="n">posterior</span>

<span class="ne">NameError</span>: name 'az' is not defined
</pre></div>
</div>
<p>Given how we have constructed our dataset, the default order is <code class="docutils literal notranslate"><span class="pre">experiment,</span> <span class="pre">subject,</span> <span class="pre">date</span></code>.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Click to see the default summary<div class="sd-summary-down docutils">
<svg aria-hidden="true" class="sd-octicon sd-octicon-chevron-down" height="1.5em" version="1.1" viewbox="0 0 24 24" width="1.5em"><path d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z" fill-rule="evenodd"></path></svg></div>
<div class="sd-summary-up docutils">
<svg aria-hidden="true" class="sd-octicon sd-octicon-chevron-up" height="1.5em" version="1.1" viewbox="0 0 24 24" width="1.5em"><path d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z" fill-rule="evenodd"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">experiments</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">experiments</span><span class="p">)</span>

<span class="ne">NameError</span>: name 'az' is not defined
</pre></div>
</div>
</div>
</details><p>However, the order we want is: <code class="docutils literal notranslate"><span class="pre">subject,</span> <span class="pre">date,</span> <span class="pre">experiment</span></code>.
Now, to get the desired result, we need to modify the underlying xarray object.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [13]: </span><span class="n">dim_order</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"chain"</span><span class="p">,</span> <span class="s2">"draw"</span><span class="p">,</span> <span class="s2">"subject"</span><span class="p">,</span> <span class="s2">"date"</span><span class="p">,</span> <span class="s2">"experiment"</span><span class="p">)</span>

<span class="gp">In [14]: </span><span class="n">experiments</span> <span class="o">=</span> <span class="n">experiments</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="o">*</span><span class="n">dim_order</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">experiments</span> <span class="o">=</span> <span class="n">experiments</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="o">*</span><span class="n">dim_order</span><span class="p">)</span>

<span class="ne">NameError</span>: name 'experiments' is not defined

<span class="gp">In [15]: </span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">experiments</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">experiments</span><span class="p">)</span>

<span class="ne">NameError</span>: name 'az' is not defined
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>However, we don’t need to overwrite or store the modified xarray object.
Doing <code class="docutils literal notranslate"><span class="pre">az.summary(experiments.posterior.transpose(*dim_order))</span></code> would work just the same
if we only want to use this order once.</p>
</div>
</section>
</section>
<section id="labeling-with-indexes">
<h2>Labeling with indexes<a class="headerlink" href="#labeling-with-indexes" title="Permalink to this headline">#</a></h2>
<p>As you may have seen, there are some labellers with <code class="docutils literal notranslate"><span class="pre">Idx</span></code> in their name:
<code class="xref py py-class docutils literal notranslate"><span class="pre">IdxLabeller</span></code> and  <code class="xref py py-class docutils literal notranslate"><span class="pre">DimIdxLabeller</span></code>.
They show the positional index of the values instead of their corresponding coordinate value.</p>
<p>We have seen before that we can use the <code class="docutils literal notranslate"><span class="pre">coords</span></code> argument or
the <code class="xref py py-meth docutils literal notranslate"><span class="pre">sel()</span></code> method to select data based on the coordinate values.
Similarly, we can use the <code class="xref py py-meth docutils literal notranslate"><span class="pre">isel()</span></code> method to select data based on positional indexes.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [16]: </span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">schools</span><span class="p">,</span> <span class="n">labeller</span><span class="o">=</span><span class="n">azl</span><span class="o">.</span><span class="n">IdxLabeller</span><span class="p">())</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">schools</span><span class="p">,</span> <span class="n">labeller</span><span class="o">=</span><span class="n">azl</span><span class="o">.</span><span class="n">IdxLabeller</span><span class="p">())</span>

<span class="ne">NameError</span>: name 'az' is not defined
</pre></div>
</div>
<p>After seeing the above summary, let’s use <code class="docutils literal notranslate"><span class="pre">isel</span></code> method to generate the summary of a subset only.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [17]: </span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">schools</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">school</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]),</span> <span class="n">labeller</span><span class="o">=</span><span class="n">azl</span><span class="o">.</span><span class="n">IdxLabeller</span><span class="p">())</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">schools</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">school</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]),</span> <span class="n">labeller</span><span class="o">=</span><span class="n">azl</span><span class="o">.</span><span class="n">IdxLabeller</span><span class="p">())</span>

<span class="ne">NameError</span>: name 'az' is not defined
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Positional indexing is NOT label based indexing with numbers!</p>
</div>
<p>The positional indexes shown will correspond to the ordinal position in the <em>subsetted object</em>.
If you are not subsetting the object, you can use these indexes with <code class="docutils literal notranslate"><span class="pre">isel</span></code> without problem.
However, if you are subsetting the data (either directly or with the <code class="docutils literal notranslate"><span class="pre">coords</span></code> argument)
and want to use the positional indexes shown, you need to use them on the corresponding subset.</p>
<p><strong>Example</strong>: If you use a dict named <code class="docutils literal notranslate"><span class="pre">coords</span></code> when calling a plotting function,
for <code class="docutils literal notranslate"><span class="pre">isel</span></code> to work it has to be called on
<code class="docutils literal notranslate"><span class="pre">original_idata.sel(**coords).isel(&lt;desired</span> <span class="pre">positional</span> <span class="pre">idxs&gt;)</span></code> and
not on <code class="docutils literal notranslate"><span class="pre">original_idata.isel(&lt;desired</span> <span class="pre">positional</span> <span class="pre">idxs&gt;)</span></code>.</p>
</section>
<section id="labeller-mixtures">
<h2>Labeller mixtures<a class="headerlink" href="#labeller-mixtures" title="Permalink to this headline">#</a></h2>
<p>In some cases, none of the available labellers do the right job.
For example, one case where this is bound to happen is with <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_forest()</span></code>.
When setting <code class="docutils literal notranslate"><span class="pre">legend=True</span></code> it does not really make sense to add the model name to the tick labels.
<code class="docutils literal notranslate"><span class="pre">plot_forest</span></code> knows that, and if no <code class="docutils literal notranslate"><span class="pre">labeller</span></code> is passed, it uses either
<code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLabeller</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">NoModelLabeller</span></code> depending on the value of <code class="docutils literal notranslate"><span class="pre">legend</span></code>.
However, if we do want to use the <code class="docutils literal notranslate"><span class="pre">labeller</span></code> argument, we have to enforce this default ourselves:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [18]: </span><span class="n">schools2</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">load_XGenTS_data</span><span class="p">(</span><span class="s2">"non_centered_eight"</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">schools2</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">load_XGenTS_data</span><span class="p">(</span><span class="s2">"non_centered_eight"</span><span class="p">)</span>

<span class="ne">NameError</span>: name 'az' is not defined

<span class="gp">In [19]: </span><span class="n">az</span><span class="o">.</span><span class="n">plot_forest</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="p">(</span><span class="n">schools</span><span class="p">,</span> <span class="n">schools2</span><span class="p">),</span>
<span class="gp">   ....: </span>    <span class="n">model_names</span><span class="o">=</span><span class="p">(</span><span class="s2">"centered"</span><span class="p">,</span> <span class="s2">"non_centered"</span><span class="p">),</span>
<span class="gp">   ....: </span>    <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">"school"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Deerfield"</span><span class="p">,</span> <span class="s2">"Lawrenceville"</span><span class="p">,</span> <span class="s2">"Mt. Hermon"</span><span class="p">]},</span>
<span class="gp">   ....: </span>    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span>
<span class="gp">   ....: </span>    <span class="n">labeller</span><span class="o">=</span><span class="n">azl</span><span class="o">.</span><span class="n">DimCoordLabeller</span><span class="p">(),</span>
<span class="gp">   ....: </span>    <span class="n">legend</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">   ....: </span><span class="p">);</span>
<span class="gp">   ....: </span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">az</span><span class="o">.</span><span class="n">plot_forest</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>     <span class="p">(</span><span class="n">schools</span><span class="p">,</span> <span class="n">schools2</span><span class="p">),</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="n">model_names</span><span class="o">=</span><span class="p">(</span><span class="s2">"centered"</span><span class="p">,</span> <span class="s2">"non_centered"</span><span class="p">),</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">"school"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Deerfield"</span><span class="p">,</span> <span class="s2">"Lawrenceville"</span><span class="p">,</span> <span class="s2">"Mt. Hermon"</span><span class="p">]},</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="n">labeller</span><span class="o">=</span><span class="n">azl</span><span class="o">.</span><span class="n">DimCoordLabeller</span><span class="p">(),</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="n">legend</span><span class="o">=</span><span class="kc">True</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="p">);</span>

<span class="ne">NameError</span>: name 'az' is not defined
</pre></div>
</div>
<img alt="../_images/default_plot_forest.png" src="../_images/default_plot_forest.png"/>
<p>There is a lot of repeated information now.
The variable names, <code class="docutils literal notranslate"><span class="pre">dims</span></code> and <code class="docutils literal notranslate"><span class="pre">coords</span></code> are shown for both models.
Moreover, the models are labeled both in the legend and in the labels of the y axis.
For such cases, XGenTS provides a convenience function <code class="xref py py-func docutils literal notranslate"><span class="pre">mix_labellers()</span></code>
that combines labeller classes for some extra customization.</p>
<p><strong>Labeller classes</strong> aim to split labeling into atomic tasks and have a method per task to maximize extensibility.
Thus, many new labellers can be created with this mixer function alone without needing to write a new class from scratch.
There are more usage examples of <code class="xref py py-func docutils literal notranslate"><span class="pre">mix_labellers()</span></code> in its docstring page, click on
it to go there.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [20]: </span><span class="n">MixtureLabeller</span> <span class="o">=</span> <span class="n">azl</span><span class="o">.</span><span class="n">mix_labellers</span><span class="p">((</span><span class="n">azl</span><span class="o">.</span><span class="n">DimCoordLabeller</span><span class="p">,</span> <span class="n">azl</span><span class="o">.</span><span class="n">NoModelLabeller</span><span class="p">))</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">MixtureLabeller</span> <span class="o">=</span> <span class="n">azl</span><span class="o">.</span><span class="n">mix_labellers</span><span class="p">((</span><span class="n">azl</span><span class="o">.</span><span class="n">DimCoordLabeller</span><span class="p">,</span> <span class="n">azl</span><span class="o">.</span><span class="n">NoModelLabeller</span><span class="p">))</span>

<span class="ne">NameError</span>: name 'azl' is not defined

<span class="gp">In [21]: </span><span class="n">az</span><span class="o">.</span><span class="n">plot_forest</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="p">(</span><span class="n">schools</span><span class="p">,</span> <span class="n">schools2</span><span class="p">),</span>
<span class="gp">   ....: </span>    <span class="n">model_names</span><span class="o">=</span><span class="p">(</span><span class="s2">"centered"</span><span class="p">,</span> <span class="s2">"non_centered"</span><span class="p">),</span>
<span class="gp">   ....: </span>    <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">"school"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Deerfield"</span><span class="p">,</span> <span class="s2">"Lawrenceville"</span><span class="p">,</span> <span class="s2">"Mt. Hermon"</span><span class="p">]},</span>
<span class="gp">   ....: </span>    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span>
<span class="gp">   ....: </span>    <span class="n">labeller</span><span class="o">=</span><span class="n">MixtureLabeller</span><span class="p">(),</span>
<span class="gp">   ....: </span>    <span class="n">legend</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">   ....: </span><span class="p">);</span>
<span class="gp">   ....: </span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">21</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">az</span><span class="o">.</span><span class="n">plot_forest</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>     <span class="p">(</span><span class="n">schools</span><span class="p">,</span> <span class="n">schools2</span><span class="p">),</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="n">model_names</span><span class="o">=</span><span class="p">(</span><span class="s2">"centered"</span><span class="p">,</span> <span class="s2">"non_centered"</span><span class="p">),</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">"school"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Deerfield"</span><span class="p">,</span> <span class="s2">"Lawrenceville"</span><span class="p">,</span> <span class="s2">"Mt. Hermon"</span><span class="p">]},</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="n">labeller</span><span class="o">=</span><span class="n">MixtureLabeller</span><span class="p">(),</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="n">legend</span><span class="o">=</span><span class="kc">True</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="p">);</span>

<span class="ne">NameError</span>: name 'az' is not defined
</pre></div>
</div>
<img alt="../_images/mixture_plot_forest.png" src="../_images/mixture_plot_forest.png"/>
</section>
<section id="custom-labellers">
<h2>Custom labellers<a class="headerlink" href="#custom-labellers" title="Permalink to this headline">#</a></h2>
<p>So far we have managed to customize the labels in the plots without writing a new class
from scratch. However, there could be cases where we have to customize our labels
further than what these sample labellers allow. In such cases, we have to subclass one of the
labellers in <span class="xref std std-ref">XGenTS.labels</span> and override some of its methods.</p>
<p>One case where we might need to do use this approach is when non indexing coordinates are present.
This happens for example after doing pointwise selection on multiple dimensions,
but we can also add extra dimensions to our models manually, as shown in TBD.
For this example, let’s use pointwise selection.
Let’s say one of the variables in the posterior represents a <a class="reference external" href="https://en.wikipedia.org/wiki/Covariance_matrix">covariance matrix</a>, and we want
to keep it as is for other post-processing tasks instead of extracting the sub diagonal <a class="reference external" href="https://en.wikipedia.org/wiki/Triangular_matrix)">triangular
matrix</a> with no repeated info as a flattened array. Or any other pointwise selection.</p>
<p>Here is our data:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [22]: </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">default_rng</span>

<span class="gp">In [23]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [24]: </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://docs.xarray.dev/en/stable/index.html#module-xarray" title="xarray"><span class="nn">xarray</span></a> <span class="k">as</span> <span class="nn">xr</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="ne">ModuleNotFoundError</span>: No module named 'xarray'

<span class="gp">In [25]: </span><span class="n">rng</span> <span class="o">=</span> <span class="n">default_rng</span><span class="p">()</span>

<span class="gp">In [26]: </span><span class="n">cov</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="gp">In [27]: </span><span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">"...ij,...kj"</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="n">cov</span><span class="p">)</span>

<span class="gp">In [28]: </span><span class="n">cov</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="gp">In [29]: </span><span class="n">subjects</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"ecoli"</span><span class="p">,</span> <span class="s2">"pseudomonas"</span><span class="p">,</span> <span class="s2">"clostridium"</span><span class="p">]</span>

<span class="gp">In [30]: </span><span class="n">idata</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="p">{</span><span class="s2">"cov"</span><span class="p">:</span> <span class="n">cov</span><span class="p">},</span>
<span class="gp">   ....: </span>    <span class="n">dims</span><span class="o">=</span><span class="p">{</span><span class="s2">"cov"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"subject"</span><span class="p">,</span> <span class="s2">"subject bis"</span><span class="p">]},</span>
<span class="gp">   ....: </span>    <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">"subject"</span><span class="p">:</span> <span class="n">subjects</span><span class="p">,</span> <span class="s2">"subject bis"</span><span class="p">:</span> <span class="n">subjects</span><span class="p">}</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">30</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">idata</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>     <span class="p">{</span><span class="s2">"cov"</span><span class="p">:</span> <span class="n">cov</span><span class="p">},</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="n">dims</span><span class="o">=</span><span class="p">{</span><span class="s2">"cov"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"subject"</span><span class="p">,</span> <span class="s2">"subject bis"</span><span class="p">]},</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">"subject"</span><span class="p">:</span> <span class="n">subjects</span><span class="p">,</span> <span class="s2">"subject bis"</span><span class="p">:</span> <span class="n">subjects</span><span class="p">}</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="p">)</span>

<span class="ne">NameError</span>: name 'az' is not defined

<span class="gp">In [31]: </span><span class="n">idata</span><span class="o">.</span><span class="n">posterior</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">31</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">idata</span><span class="o">.</span><span class="n">posterior</span>

<span class="ne">NameError</span>: name 'idata' is not defined
</pre></div>
</div>
<p>To select a non rectangular slice with xarray and to get the result flattened and without NaNs, we can
use <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> s indexed with a dimension that is not present in our current dataset:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [32]: </span><span class="n">coords</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">   ....: </span>    <span class="s1">'subject'</span><span class="p">:</span> <a class="sphinx-codeautolink-a" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.DataArray"><span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span></a><span class="p">(</span>
<span class="gp">   ....: </span>        <span class="p">[</span><span class="s2">"ecoli"</span><span class="p">,</span> <span class="s2">"ecoli"</span><span class="p">,</span> <span class="s2">"pseudomonas"</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">'pointwise_sel'</span><span class="p">]</span>
<span class="gp">   ....: </span>    <span class="p">),</span>
<span class="gp">   ....: </span>    <span class="s1">'subject bis'</span><span class="p">:</span> <a class="sphinx-codeautolink-a" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.DataArray"><span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span></a><span class="p">(</span>
<span class="gp">   ....: </span>        <span class="p">[</span><span class="s2">"pseudomonas"</span><span class="p">,</span> <span class="s2">"clostridium"</span><span class="p">,</span> <span class="s2">"clostridium"</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">'pointwise_sel'</span><span class="p">]</span>
<span class="gp">   ....: </span>    <span class="p">)</span>
<span class="gp">   ....: </span><span class="p">}</span>
<span class="gp">   ....: </span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">32</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span>
<span class="ne">----&gt; </span><span class="mi">2</span>     <span class="s1">'subject'</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>         <span class="p">[</span><span class="s2">"ecoli"</span><span class="p">,</span> <span class="s2">"ecoli"</span><span class="p">,</span> <span class="s2">"pseudomonas"</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">'pointwise_sel'</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="p">),</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="s1">'subject bis'</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>         <span class="p">[</span><span class="s2">"pseudomonas"</span><span class="p">,</span> <span class="s2">"clostridium"</span><span class="p">,</span> <span class="s2">"clostridium"</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">'pointwise_sel'</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="p">}</span>

<span class="ne">NameError</span>: name 'xr' is not defined

<span class="gp">In [33]: </span><span class="n">idata</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">33</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">idata</span><span class="o">.</span><span class="n">posterior</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>

<span class="ne">NameError</span>: name 'idata' is not defined
</pre></div>
</div>
<p>We see now that <code class="docutils literal notranslate"><span class="pre">subject</span></code> and <code class="docutils literal notranslate"><span class="pre">subject</span> <span class="pre">bis</span></code> are no longer indexing coordinates, and
therefore won’t be available to the <code class="docutils literal notranslate"><span class="pre">labeller</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [34]: </span><span class="n">az</span><span class="o">.</span><span class="n">plot_posterior</span><span class="p">(</span><span class="n">idata</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../_images/default_plot_posterior.png" src="../_images/default_plot_posterior.png"/>
<p>To get around this limitation, we will store the <code class="docutils literal notranslate"><span class="pre">coords</span></code> used for pointwise selection
as a Dataset. We will pass this Dataset to the <code class="docutils literal notranslate"><span class="pre">labeller</span></code> so it can use the info it has available
(<code class="docutils literal notranslate"><span class="pre">pointwise_sel</span></code> and its position in this case) to subset this <code class="docutils literal notranslate"><span class="pre">coords</span></code> Dataset
and use that instead to label.
One option is to format these non-indexing coordinates as a dictionary whose
keys are dimension names and values are coordinate labels and pass that to the parent’s
<code class="docutils literal notranslate"><span class="pre">sel_to_str</span></code> method:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [35]: </span><span class="n">coords_ds</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="xarray.Dataset"><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span></a><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">35</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">coords_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>

<span class="ne">NameError</span>: name 'xr' is not defined

<span class="gp">In [36]: </span><span class="k">class</span> <span class="nc">NonIdxCoordLabeller</span><span class="p">(</span><span class="n">azl</span><span class="o">.</span><span class="n">BaseLabeller</span><span class="p">):</span>
<span class="gp">   ....: </span><span class="w">    </span><span class="sd">"""Use non indexing coordinates as labels."""</span>
<span class="gp">   ....: </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coords_ds</span><span class="p">):</span>
<span class="gp">   ....: </span>        <span class="bp">self</span><span class="o">.</span><span class="n">coords_ds</span> <span class="o">=</span> <span class="n">coords_ds</span>
<span class="gp">   ....: </span>    <span class="k">def</span> <span class="nf">sel_to_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sel</span><span class="p">,</span> <span class="n">isel</span><span class="p">):</span>
<span class="gp">   ....: </span>        <span class="n">new_sel</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords_ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<span class="gp">   ....: </span>        <span class="k">return</span> <a class="sphinx-codeautolink-a" href="https://docs.python.org/3/library/functions.html#super" title="super"><span class="nb">super</span></a><span class="p">()</span><span class="o">.</span><span class="n">sel_to_str</span><span class="p">(</span><span class="n">new_sel</span><span class="p">,</span> <span class="n">new_sel</span><span class="p">)</span>
<span class="gp">   ....: </span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">36</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="k">class</span> <span class="nc">NonIdxCoordLabeller</span><span class="p">(</span><span class="n">azl</span><span class="o">.</span><span class="n">BaseLabeller</span><span class="p">):</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span><span class="w">     </span><span class="sd">"""Use non indexing coordinates as labels."""</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coords_ds</span><span class="p">):</span>

<span class="ne">NameError</span>: name 'azl' is not defined

<span class="gp">In [37]: </span><span class="n">labeller</span> <span class="o">=</span> <span class="n">NonIdxCoordLabeller</span><span class="p">(</span><span class="n">coords_ds</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">37</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">labeller</span> <span class="o">=</span> <span class="n">NonIdxCoordLabeller</span><span class="p">(</span><span class="n">coords_ds</span><span class="p">)</span>

<span class="ne">NameError</span>: name 'NonIdxCoordLabeller' is not defined

<span class="gp">In [38]: </span><span class="n">az</span><span class="o">.</span><span class="n">plot_posterior</span><span class="p">(</span><span class="n">idata</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span> <span class="n">labeller</span><span class="o">=</span><span class="n">labeller</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../_images/custom_plot_posterior1.png" src="../_images/custom_plot_posterior1.png"/>
<p>This has the following advantages:</p>
<ul class="simple">
<li><p>It requires very little extra code.</p></li>
<li><p>It allows to combine our newly created <code class="docutils literal notranslate"><span class="pre">NonIdxCoordLabeller</span></code> with other labellers as we did in the previous section.</p></li>
</ul>
<p>Another option is to go for a much more customized look, and handle everything
on <code class="xref py py-meth docutils literal notranslate"><span class="pre">make_label_vert()</span></code> to get labels like “Correlation between subjects x and y”.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [39]: </span><span class="k">class</span> <span class="nc">NonIdxCoordLabeller</span><span class="p">(</span><span class="n">azl</span><span class="o">.</span><span class="n">BaseLabeller</span><span class="p">):</span>
<span class="gp">   ....: </span><span class="w">    </span><span class="sd">"""Use non indexing coordinates as labels."""</span>
<span class="gp">   ....: </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coords_ds</span><span class="p">):</span>
<span class="gp">   ....: </span>        <span class="bp">self</span><span class="o">.</span><span class="n">coords_ds</span> <span class="o">=</span> <span class="n">coords_ds</span>
<span class="gp">   ....: </span>    <span class="k">def</span> <span class="nf">make_label_vert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">sel</span><span class="p">,</span> <span class="n">isel</span><span class="p">):</span>
<span class="gp">   ....: </span>        <span class="n">coords_ds_subset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords_ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span>
<span class="gp">   ....: </span>        <span class="n">subj</span> <span class="o">=</span> <span class="n">coords_ds_subset</span><span class="p">[</span><span class="s2">"subject"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="gp">   ....: </span>        <span class="n">subj_bis</span> <span class="o">=</span> <span class="n">coords_ds_subset</span><span class="p">[</span><span class="s2">"subject bis"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="gp">   ....: </span>        <span class="k">return</span> <span class="sa">f</span><span class="s2">"Correlation between subjects</span><span class="se">\n</span><span class="si">{</span><span class="n">subj</span><span class="si">}</span><span class="s2"> &amp; </span><span class="si">{</span><span class="n">subj_bis</span><span class="si">}</span><span class="s2">"</span>
<span class="gp">   ....: </span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">39</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="k">class</span> <span class="nc">NonIdxCoordLabeller</span><span class="p">(</span><span class="n">azl</span><span class="o">.</span><span class="n">BaseLabeller</span><span class="p">):</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span><span class="w">     </span><span class="sd">"""Use non indexing coordinates as labels."""</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coords_ds</span><span class="p">):</span>

<span class="ne">NameError</span>: name 'azl' is not defined

<span class="gp">In [40]: </span><span class="n">labeller</span> <span class="o">=</span> <span class="n">NonIdxCoordLabeller</span><span class="p">(</span><span class="n">coords_ds</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">40</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">labeller</span> <span class="o">=</span> <span class="n">NonIdxCoordLabeller</span><span class="p">(</span><span class="n">coords_ds</span><span class="p">)</span>

<span class="ne">NameError</span>: name 'NonIdxCoordLabeller' is not defined

<span class="gp">In [41]: </span><span class="n">az</span><span class="o">.</span><span class="n">plot_posterior</span><span class="p">(</span><span class="n">idata</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span> <span class="n">labeller</span><span class="o">=</span><span class="n">labeller</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../_images/custom_plot_posterior2.png" src="../_images/custom_plot_posterior2.png"/>
<p>This won’t combine properly with other labellers, but it serves its function and
achieves complete customization of the labels, so we probably won’t want to combine
it with other labellers either. The main drawback is that we have only overridden
<code class="docutils literal notranslate"><span class="pre">make_label_vert</span></code>, so functions like <code class="docutils literal notranslate"><span class="pre">plot_forest</span></code> or <code class="docutils literal notranslate"><span class="pre">summary</span></code> who
use <code class="xref py py-meth docutils literal notranslate"><span class="pre">make_label_flat()</span></code> will still fall back to the methods defined by <code class="docutils literal notranslate"><span class="pre">BaseLabeller</span></code>.</p>
</section>
</section>
</article>
<footer class="bd-footer-article">
</footer>
</div>
<div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">
<div class="sidebar-secondary-item">
<div class="page-toc tocsection onthispage">
<i class="fa-solid fa-list"></i> On this page
  </div>
<nav class="bd-toc-nav page-toc">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-labelling">Basic labelling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-default-labelling">Example: Default labelling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-label-based-indexing">Example: Label based indexing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-using-the-labeller-argument">Example: Using the labeller argument</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-labels">Sorting labels</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-variable-names">Sorting variable names</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-coordinate-values">Sorting coordinate values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-sorting-the-schools-by-mean">Example: Sorting the schools by mean</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-dimensions">Sorting dimensions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#labeling-with-indexes">Labeling with indexes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#labeller-mixtures">Labeller mixtures</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-labellers">Custom labellers</a></li>
</ul>
</nav></div>
<div class="sidebar-secondary-item">
<div id="searchbox"></div></div>
<div class="sidebar-secondary-item">
<div class="tocsection editthispage">
<a href="https://github.com/XGenTS-devs/XGenTS/edit/main/docs/source/dush/label_guide.rst">
<i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
</div>
</div>
<div class="sidebar-secondary-item">
<div class="tocsection sourcelink">
<a href="../_sources/dush/label_guide.rst.txt">
<i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>
</div>
</div></div>
</div>
<footer class="bd-footer-content">
</footer>
</main>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>
<script>
  $(document).ready(function () {
    const content = $('<div class="alert-danger">XGenTS docs will now be available at <a href="https://python.XGenTS.org">python.XGenTS.org</a>!</div>')
    $('#banner').append(content);
  })
</script>
<footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
<div class="footer-items__start">
<div class="footer-item">
<p class="copyright">
    
      © Copyright 2023, XGenTS devs.
      <br/>
</p>
</div>
</div>
<div class="footer-items__end">
<div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
</div>
</div>
</footer>
</body>
</html>